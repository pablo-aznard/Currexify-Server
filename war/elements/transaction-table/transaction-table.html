<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import"
	href="../../bower_components/paper-styles/typography.html">

<dom-module id="transaction-table"> <template>
<style>
:host {
	display: block;
}

span { @apply (--paper-font-body1);
	
}

.rojo {
	color: #FF5252
}

.verde {
	color: #4CAF50
}

.neutral {
	color: #777
}
</style>
<div style="width: 100%; margin-top: 20px">
	
	<table style="padding: 10px; width: 100%; background-color: #EEE; border-bottom: 1px solid #ccc">
		<tr
		style="background-color: #666; color: white; padding: 10px 0 10px 10px;">
			<th colspan="4"><span style="font-size: 18px; font-weight: bold">{{title}}</span></th>
		</tr>
	
		<template is="dom-if" if="{{checkHistory()}}">
		<tr>
			<td colspan="4" style="text-align: center"><span>No tienes historial de transacciones</span></td>
		</tr>
		</template>
		<template is="dom-repeat" items="{{transactions}}" as="item">
			<tr>
				<td style="width:24%"><span style="margin-right: 60px; float: left;">{{item.user}}</span></td>
				<td style="width:24%"><span style="margin-right: 60px; float: left;">{{item.date}}</span></td>
				<td style="width:24%"><span class$="{{checkType(item.type)}}"
					style="margin-right: 30px; float: right;">{{item.type}}</span></td>
				<td style="width:24%">
					<span class$="{{checkType(item.type)}}" style="margin-right: 30px; float: right;">{{checkMoves(item.type)}}{{item.quantity}}</span>
				</td>
			</tr>
		</template>
	</table>
	
	<table style="width: 100%; margin-top: 50px">
		<tr style="width: 100%; background-color: #666; color: white; padding: 10px 0 10px 10px;">
			<th style="width: 15%">Nombre</th>
			<th style="width: 15%">Petici&oacute;n</th>
			<th style="width: 15%">Moneda</th>
			<th style="width: 15%">Daci&oacute;n</th>
			<th style="width: 15%">Moneda</th>
			<th style="width: 15%">Acciones</th>
		</tr>
		<template is="dom-if" if="{{checkFriend()}}">
		<tr>
			<td colspan="6" style="text-align: center"><span>No tienes transaccones de amigos</span></td>
		</tr>
		</template>
		<template is="dom-repeat" items="{{friends}}" as="item">
			<tr style="width: 100%;">
						<td style="width: 15%; text-align: center"><span>{{item.friend}}</span></td>
						<td style="width: 15%; text-align: center"><span>{{roundNumber(item.quantityD)}}</span></td>
						<td style="width: 15%; text-align: center"><span>{{item.coinD}}</span></td>
						<td style="width: 15%; text-align: center"><span>{{roundNumber(item.quantityS)}}</span></td>
						<td style="width: 15%; text-align: center"><span>{{item.coinS}}</span></td>
						<td style="width: 15%; text-align: center">
							<form action="/newtransaction?amigo=true" method="post">
								<input hidden name="friend" value="{{item.friend}}">
								<input hidden name="amount" value="{{item.quantityD}}">
								<input hidden name="coinD" value="{{item.coinD}}">
								<input hidden name="amount" value="{{item.quantityS}}">
								<input hidden name="coinS" value="{{item.coinS}}">
								<button type="submit" name="action" style="background-color: transparent; border:none"><iron-icon icon="check" style="color:green"></iron-icon></button>
								<button type="submit" name="action" style="background-color: transparent; border:none"><iron-icon icon="clear" style="color:red"></iron-icon></button> 		
							</form>
						</td>
			</span>
		</template>	
	</table>
</div>
</template> <script>
	(function() {
		'use strict';

		Polymer({
			is : 'transaction-table',

			properties : {
				title : {
					type : "String",
					value : "Transactions"
				},
				transactions : {
					type : Array,
					value : []
				},
				friends: {
					type: Array,
					value: []
				}
			},

			ready : function() {
				var that = this;
			},

			checkType : function(type) {
				if (type == "saliente") {
					return "rojo"
				} else if (type == "entrante"){
					return "verde"
				} else if (type == "bloqueado") {
					return "neutral"
				}

			},

			checkMoves : function(type) {
				if (type == "saliente" || type == "bloqueado") {
					return "-"
				} else if (type == "entrante"){
					return "+"
				}
			},
			
			checkFriend: function() {
				if (this.friends == undefined){
					return true
				} else {
					return false
				}	
			},
			
			checkHistory: function() {
				if (this.transactions == undefined){
					return true
				} else {
					return false
				}
			},
			
			roundNumber: function(number) {
				return Math.round(number*100)/100;
			}
		});
	})();
</script> </dom-module>
